<!DOCTYPE html>
<html lang="en">


<head>
    <title>SearchPage</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="./css/searchPageCss.css">
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/solid.js" integrity="sha384-tzzSw1/Vo+0N5UhStP3bvwWPq+uvzCMfrN1fEFe+xBmv1C/AtVX5K0uZtmcHitFZ" crossorigin="anonymous"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/fontawesome.js" integrity="sha384-6OIrr52G08NpOFSZdxxz1xdNSndlD4vdcf/q2myIUVO0VsqaGHJsB0RaBE01VTOY" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">


</head>

<body>
    <div class="wrapper">
        <!-- Sidebar for desktop -->
        <nav id="sidebar" class="active">
            <div class="sidebar-header">
                <h3><span id="span1" class="animated rotateInDownLeft slow">Food</span> <span id="span2" class="animated rotateInDownRight slow">Score</span></h3>
            </div>

            <ul class="list-unstyled components">
                <li>
                    <a href="searchPage.html">Home</a>
                </li>
                <li>
                    <a href="profile.html">My Profile</a>
                </li>
                <li>
                    <a href="#">Help</a>
                </li>
                <li>
                    <a href="#">History</a>
                </li>
                <li>
                    <a href="#">Contact Us</a>
                </li>
            </ul>
        </nav>
        <!-- Sidebar for mobile-->
        <nav id="sidebar1">
            <!--
            <div id="dismiss1">

                <i class="fas fa-times" id="left1"></i>
            </div>
-->

            <div class="sidebar-header">
                <h3><span id="span1">Food</span> <span id="span2">Score</span></h3>
            </div>

            <ul class="list-unstyled components">
                <li>
                    <a href="searchPage.html" id="homebt">Home</a>
                </li>
                <li>
                    <a href="profile.html">My Profile</a>
                </li>
                <li>
                    <a href="helppage.html">Help</a>
                </li>
                <li>
                    <a href="#">History</a>
                </li>
                <li>
                    <a href="#">Contact Us</a>
                </li>
            </ul>
        </nav>
        <!-- Page Content -->
        <div id="content">
            <nav>
                <div class="container-fluid">
                    <!--button animation debug-->
                    <button type="button" id="sidebarCollapse" class="navbar-btn active">
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>
                    <button type="button" id="sidebarCollapse1" class="navbar-btn ">
                        <i class="fas fa-bars" id="left"></i>
                    </button>
                </div>
            </nav>

            <div class="text-center" id="logoContainer">
                <img src="./Pictures/Logo.png" id="logo" class="rounded" alt="logo">
            </div>
            <div class="text-center">
                <img src="./Pictures/LogoM.png" id="logoM" class="rounded animated bounceIn" alt="logo">
            </div>

            <!--
            <form class="form-inline">
                <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
                <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
            </form>
-->


            <div class="row justify-content-center" id="searchBar">

                <div class="col-12 col-md-10 col-lg-8">


                    <form class="card-sm " id="tryjs">

                        <div class="card-body row no-gutters align-items-center" id="tryImg">

                            <!--end of col-->
                            <div class="col" id="trysearchBarKeyWord">
                                <input class="form-control form-control-lg form-control-borderless" type="search" placeholder="Search keywords or upload photo" id="textField">
                            </div>

                            <!--end of col-->
                            <div class="col-auto" id="trysearch">
                                <button class="btn btn-lg btn-success" type="button" id="submit">Search</button>
                            </div>

                            <div class="col-auto" id="trycamera">
                                <button type="button" class="btn btn-lg btn-success" id="camerabtn">
                                    <i class="fa fa-camera" id="camera"></i>
                                </button>
                            </div>

                            <div class="uploadimg">

                                <div class="upload-options" id="uploadContainer">
                                    <label>
                                        <input type="file" class="image-upload" accept="image/*" id="imageUpload" onchange="loadFile(event)">

                                    </label>
                                </div>
                            </div>

                            <!--end of col-->
                        </div>

                    </form>

                </div>
                <!--end of col-->

            </div>

            <div class="container">
                <div class="row">
                    <div class="col-sm-5">
                        <div id="detailsBox" style="display: none">
                            <div id="prodName" style="display: none"></div>
                            <div id="score" style="display: none">Score:<span id="foodScore"></span>/10</div>
                            <div id="listChoice" style="display: none">Add to list?</div>
                            <div id="yes" style="display: none">Yes</div>
                            <div id="no" style="display: none">No</div>
                        </div>
                    </div>
                    <div class="col-sm-2">

                    </div>
                    <div id="dropdownHolder" class="col-sm-5">
                        <div id="detailsDropdown" style="display: none">Details<span id="detailsPlus">+</span>
                            <li id="row1" style="display: none"></li>
                            <li id="row2" style="display: none"></li>
                            <li id="row3" style="display: none"></li>
                            <li id="row4" style="display: none"></li>
                        </div>
                    </div>
                </div>
            </div>

            <!--
            <div id="detailsDropdown" style="display: none">Details<span id="detailsPlus">+</span></div>
            <div id="detailsBox" style="display: none">
            <div id="score" style="display: none">Score:<span id="foodScore"></span><span id="outOfTen"> /10</span></div>
            <div id="listChoice" style="display: none">Add to list?</div>
            <div id="yes" style="display: none">Yes</div>
            <div id="no" style="display: none">No</div>
            </div>
-->

        </div>
        <div class="overlay"></div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/5.11.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.11.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.11.1/firebase-auth.js"></script>
    <script>
        // Your web app's Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyAqKxtkDyuT3IKCrtXsEW7eWMG97DL6PFw",
            authDomain: "comp2930-3639b.firebaseapp.com",
            databaseURL: "https://comp2930-3639b.firebaseio.com",
            projectId: "comp2930-3639b",
            storageBucket: "comp2930-3639b.appspot.com",
            messagingSenderId: "773056439844",
            appId: "1:773056439844:web:5803d640de8e0613"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
    </script>



    <!--bootstrap-->
    <script src="https://code.jquery.com/jquery-3.1.0.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.concat.min.js"></script>
    
    <!-- Popper.JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <!-- Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
    <!-- jQuery Custom Scroller CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.concat.min.js"></script>
    
    
    <!-- Toggling-->
    <script src="./js/searchPageSidebarD.js"></script>

    <script src="js/searchpage.js"></script>
    <script src="./js/searchPageClick.js"></script>
    <!--    sidebar for mobile-->
    <script src="./js/searchPageSidebarM.js"></script>

<!--    <script src="js/client.js"></script>-->
    <script src="js/searchPageJS.js"></script>
    <!--    detects support for HTML file input using a mix of feature and browser detection-->
    <script>
        function isUploadSupported() {
            if (navigator.userAgent.match(/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1.0|2.0|2.5|3.0))/)) {
                return false;
            }
            var elem = document.createElement('input');
            elem.type = 'file';
            return !elem.disabled;
        };
        //        Reading the File
        if (window.File && window.FileReader && window.FormData) {
            var $inputField = $('#file');

            $inputField.on('change', function(e) {
                var file = e.target.files[0];

                if (file) {
                    if (/^image\//i.test(file.type)) {
                        readFile(file);
                    } else {
                        alert('Not a valid image!');
                    }
                }
            });
        } else {
            alert("File upload is not supported!");
        }

        //        Processing the File
        function processFile(dataURL, fileType) {
            var maxWidth = 800;
            var maxHeight = 800;

            var image = new Image();
            image.src = dataURL;

            image.onload = function() {
                var width = image.width;
                var height = image.height;
                var shouldResize = (width > maxWidth) || (height > maxHeight);

                if (!shouldResize) {
                    sendFile(dataURL);
                    return;
                }

                var newWidth;
                var newHeight;

                if (width > height) {
                    newHeight = height * (maxWidth / width);
                    newWidth = maxWidth;
                } else {
                    newWidth = width * (maxHeight / height);
                    newHeight = maxHeight;
                }

                var canvas = document.createElement('canvas');

                canvas.width = newWidth;
                canvas.height = newHeight;

                var context = canvas.getContext('2d');

                context.drawImage(this, 0, 0, newWidth, newHeight);

                dataURL = canvas.toDataURL(fileType);

                sendFile(dataURL);
            };

            image.onerror = function() {
                alert('There was an error processing your file!');
            };
        }

    </script>

    <script>
        (function() {

            //var firebase = app_firebase;
            // for the current user
            // create this user node in the datebase

            firebase.auth().onAuthStateChanged(function(user) {
                firebase.database().ref("users/" + user.uid).update({
                    "name": user.displayName,
                    "email": user.email,
                }); 
            });
        })()

    </script>

</body>

</html>
